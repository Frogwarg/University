@{
    ViewData["Title"] = "Teachers List";
    string degrees="";
    string subjects = "";
}
@model University.Models.TeachersViewModel

<form asp-action="SearchTeachers" method="get">
    <div>
        <label>ФИО: </label>
        <input type="text" name="searchFIO" placeholder="ФИО преподавателя..." value="@Model.SearchFIO" />

        <label>Ученая степень: </label>
        <select name="selectedDegree">
            <option value=""> Все степени</option>
            
            @foreach (var degree in Model.UniqueDegrees)
            {
                <option value="@degree" selected="@(Model.SelectedDegree == degree)">@degree</option>
            }
        </select>

        <label>Предмет: </label>
        <select name="selectedSubject">
            <option value="">Все предметы</option>
            @foreach (var subject in Model.Subjects)
            {
                <option value="@subject.Name" selected="@(Model.SelectedSubject != null && Model.SelectedSubject.Name == subject.Name)">@subject.Name</option>
            }
        </select>
        <input type="submit" value="Поиск" />
    </div>
</form>

<table>
    <caption>Преподаватели</caption>
    <thead>
        <td>ФИО</td>
        <td>Дата рождения</td>
        <td>Ученая степень</td>
        <td>Описание</td>
        <td>Предметы</td>
    </thead>
    
    @if (Model.FilteredTeachers != null && Model.FilteredTeachers.Any())
    {
        @foreach (var teacher in Model.FilteredTeachers)
        {
            degrees = "";
            subjects = "";
            <tr>
                <td>@(@teacher.Surname + " " + @teacher.Name + " " + @teacher.Patronymic)</td>
                <td>@teacher.DateOfBirth.ToString("dd-MM-yyyy")</td>

                @foreach (var degree in @teacher.Degrees)
                {
                    degrees += degree;
                    if (teacher.Degrees.IndexOf(degree) != teacher.Degrees.Count - 1)
                    {
                        degrees += ", ";
                    }
                }
                <td>@degrees</td>
                <td class="table__col_description">@teacher.Description</td>
                @if (teacher.Subjects != null)
                {
                    @foreach (var subject in @teacher.Subjects)
                    {
                        subjects += subject.Name;
                        if (teacher.Subjects.IndexOf(subject) != teacher.Subjects.Count - 1)
                        {
                            subjects += ", ";
                        }
                    }
                }
                else
                {
                    subjects = "Пусто";
                }

                <td>@subjects</td>
            </tr>
        }
    }
    else
    {
        <tfoot><td colspan="5">Результатов нет</td></tfoot>
    }
</table>


